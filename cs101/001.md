# 系统千千万，还得Linux 开头学

主要我最近开始学linux了，属于长期的前进分支，不把这个cs101写满101篇，我死不安心。

## 背景

1. Linux是必学的源泉，只需要知道支撑这个网络世界转起来的操作系统大概率是它这一点就足够了。
2. 因此我考虑基于centos7 2003开始，主要是学习的教程是这个版本
3. 会有大量的chatGPT参与，因为真的太好用了，但也有很多chatGPT不好用我借助传统引擎（呵呵，这么快就变成传统了）

## 过程

会按着过程记录，主要是有什么需求，完成需求的过程发现什么问题，解决问题牵扯出了什么关键点。还是要跟随课程走，不然我发散特性会深陷细节。

### 系统安装

1. 教程采用了VMware workstation for windows，但这个软件要钱，因此这部分我没有跟随。
2. linux的电脑还没到手（到了就可以花式安装了），但是mac上有parallel for mac，因此这就是我的选择。
3. https://mirrors.tuna.tsinghua.edu.cn/centos-vault/7.8.2003/isos/x86_64/CentOS-7-x86_64-DVD-2003.iso 这是清华tuna提供的版本镜像文件，需要下载。
4. parallel 和常规的安装不一样，采用了动态分配+默认帮你配置，导致我全程自主只完成了 用户名+密码 的设置。

### 不能使用桌面环境

这是遇到的第一个问题，由于2，4 的问题，导致安装好的centos7 基本是个自带桌面的。而教程全程黑框终端：用桌面的学不好linux的。因此我需要在**已经安装完GUI ** 的环境下，又回到和老师相对匹配的**最小安装** 模式。

1. 首先是求助chatGPT，我模糊的知道，linux 的命令行可以完成一切的事情。

> centos7 开启了桌面服务，应该怎么关闭，让它切换到最小安装的模式？
>
> ```bash
> // 停止图形界面服务：在文本终端中，停止并禁用图形用户界面服务。您可以使用以下命令来完成：
> sudo systemctl stop gdm    # 如果使用 GNOME 桌面
> sudo systemctl stop lightdm   # 如果使用 LightDM 桌面
> // 然后，禁用图形界面服务：
> sudo systemctl disable gdm
> sudo systemctl disable lightdm
> //如果您不确定使用的是哪种显示管理器，可以尝试执行上述两个命令并观察输出。
> //安装最小化组件：最小化安装是一个预定义的软件组，您可以通过安装它来减少系统上的软件包数量。运行以下命令来安装最小化组件：
> sudo yum install @core
> //重新启动系统：完成上述步骤后，您可以重新启动系统以应用更改
> sudo reboot
> ```

然而可惜的是，第一条命令就让虚拟机黑屏了，强制重启后，恢复了原样

2. 除了**最小安装**这个模式，我还注意到教程勾选了附加的功能：调试工具，开发工具，兼容性程序库。

想来这些都是课程必备的，我于是想到，如果GUI暂时不能去除，这几个我怎么保证是parallel黑盒安装，也记得给我安装上了呢？

于是我并没有提虚拟机的问题，而是假设这是一台真机：

> centos 7 已经安装完了，但是不是我安装的，我想知道那个人是否在安装的时候 ，勾选了 调试工具，开发工具，兼容性程序库，这三个环境附加选项，我有什么办法通过命令知道吗？
>
> ```bash
> /* 您可以通过查看安装日志来确定系统安装过程中是否选择了特定的环境附加选项。安装日志通常记录了安装过程中所做的选择和操作。在CentOS 7中，安装日志通常位于/root/anaconda-ks.cfg文件中。
> 
> 您可以使用以下命令查看该文件的内容：*/
> cat /root/anaconda-ks.cfg
> /*在输出中，您可以搜索关键字，如“调试工具”、“开发工具”、“兼容性程序库”等，以确定这些选项是否被勾选。您可以使用 grep 命令来过滤输出，例如：*/
> grep "调试工具" /root/anaconda-ks.cfg
> grep "开发工具" /root/anaconda-ks.cfg
> grep "兼容性程序库" /root/anaconda-ks.cfg
> ```
>
> 我并不知道他们在系统里叫什么，你知道的，这个文件只有英文字符，而且经常是缩写。请你从一位资深Linux专家的角度给我更多信息，这个文件我确实查看到了
>
> ```bash
> /*在CentOS 7的安装过程中，/root/anaconda-ks.cfg文件是Kickstart安装的配置文件。Kickstart是一个自动化安装系统的工具，可以通过配置文件来定义安装过程中的各种选项。
> 
> 关于您提到的调试工具、开发工具和兼容性程序库，这些选项在Kickstart配置文件中可能对应于以下内容：
> 
> 调试工具：在Kickstart配置文件中，可能会使用类似于 debug 或 debuginfo 这样的关键字来启用调试信息的安装。例如，您可能会在文件中找到如下内容：*/
> %packages
> @debugging
> %packages
> @development-tools
> %packages
> compat-libraries
> // 通过查看Kickstart配置文件中的%packages部分，您可以了解安装过程中选择了哪些软件包，从而确定是否选择了调试工具、开发工具和兼容性程序库等选项。
> ```

好像明白了，debugging是确实看到了，但是我决定打住。因为再看下去没意义，我还是得回到折腾 **怎么去掉GUI** 这个问题，包没有后面反正可以安。

3. 反复试了几个命令都无法让我顺利的回到Linux的NO GUI 状态，我觉得得上传统搜索引擎了:

> https://blog.csdn.net/qq_36076233/article/details/68958284# 
>
> 但是我的文件和他的长得不太一样，但确实有5的存在，因此我改成了3.

没想到，并没有起作用。

4. 耐心快没有了，我觉得还是得靠chatGPT

> 如果您希望将CentOS 7系统从带有桌面环境的状态还原为纯文本控制台的状态，您可以通过以下步骤完成：
>
> 1. **卸载桌面环境**：首先，您需要卸载已安装的桌面环境及相关组件。由于CentOS 7上常用的桌面环境是GNOME，您可以使用以下命令来卸载GNOME及其相关组件：
>
> ```bash
> sudo yum groupremove "GNOME Desktop"
> ```
>
> 如果您使用的是其他桌面环境（如KDE、Xfce等），则将上述命令中的`"GNOME Desktop"`替换为相应的桌面环境名称。
>
> 1. **设置默认目标为多用户目标**：CentOS 7使用Systemd作为系统和服务管理器，可以通过设置默认的Systemd目标来确定系统启动后的行为。多用户目标是一个没有图形界面的目标，适用于纯文本控制台环境。您可以使用以下命令将默认目标设置为多用户目标：
>
> ```bash
> sudo systemctl set-default multi-user.target
> ```
>
> 1. **移除显示管理器（可选）**：如果您不再需要显示管理器（例如GDM或LightDM），可以通过以下命令将其删除：
>
> ```bash
> sudo yum remove gdm   # 如果使用 GDM
> sudo yum remove lightdm  # 如果使用 LightDM
> ```
>
> 请注意，移除显示管理器可能会导致一些依赖性的变化，请谨慎操作。
>
> 1. **重新启动系统**：最后，重新启动系统以应用更改：
>
> ```bash
> sudo reboot
> ```
>
> 系统重新启动后，应该会进入纯文本控制台环境，没有图形用户界面。

这里面我觉得* 设置默认目标为多用户目标 * 应该可以试试，毕竟另外两条，之前试了没啥用。然后确实起作用了。

然后发生了新的问题....

### 字体太大了非常的影响我使用

1. 作为一个终端，字体太大了，很影响看信息，字体丑不丑都是另外再说了。最后是通过下面两篇博客来解决的，因为chatGPT给的内容不太行。

   - [Centos7终端字体大小](http://atpbike.com/article/centos/3007.html) ：背景知识

   - [修改CentOS8终端字体大小](https://www.ytyzx.org/index.php?title=%E4%BF%AE%E6%94%B9CentOS8%E7%BB%88%E7%AB%AF%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F&variant=zh) :实战

2. 其实也有一些别的问题：

   - 这么多的consolefonts ，为什么依旧被保留了，一些字符仅仅1k来个？

   - 如果想使用自己下载的otf 字体作为console字体又该怎么办？在全命令行环境下？

第一个问题关于发展历史，第二个问题关于怎么进一步优化。我选择后一个和chatGPT进行讨论。

> 怎么使用命令行下载一款otf 字体呢？
>
> ```bash
> // 你可以使用 wget 命令来从网络上下载字体文件，然后将它保存到你的系统中。以下是一种下载 OTF 字体文件的示例：
> wget https://example.com/font.otf
> /*一旦字体文件下载完成，你可以将它移动到适当的字体目录中，使其在系统中可用。通常，字体文件应该放在 /usr/share/fonts 或 ~/.fonts 目录下。然后，你可能需要更新系统的字体缓存，以确保系统可以识别到新安装的字体文件。*/
> fc-cache -f -v
> ```
>
> 又如何将它设置为consolefont 呢？
>
> ```bash
> //要将字体设置为控制台字体（console font），你需要将下载的字体文件转换为适合控制台使用的格式，然后将其应用到控制台。
> //在 CentOS 7 中，控制台字体通常存储在 /lib/kbd/consolefonts 目录下。要将字体设置为控制台字体，可以使用 setfont 命令。但在使用前，需要确保已经安装了 kbd 包，如果没有安装，可以使用以下命令安装：
> //sudo yum install kbd
> //接下来，你需要将下载的字体文件（通常是 .psf 格式）复制到 /lib/kbd/consolefonts 目录下，然后使用 setfont 命令应用它。
> //假设你已经将字体文件命名为 myfont.psf，将其复制到 /lib/kbd/consolefonts 目录下，然后运行以下命令应用该字体：
> sudo setfont myfont.psf
> // 这样就会将该字体设置为当前控制台的字体。请注意，这个设置仅在当前控制台会话中生效，重启后会恢复默认字体。如果希望永久改变控制台字体，你需要编辑 /etc/vconsole.conf 文件，设置 FONT 参数为你想要使用的字体文件名，例如：
> FONT=myfont
> ```
>
> 如果是otf 格式的字体如何做？
>
> ```bash
> //如果要在控制台中使用 OTF 格式的字体，你需要将其转换为适合控制台使用的格式，通常是 PSF（PC Screen Font）格式。你可以使用 otf2bdf 和 bdf2psf 工具来进行转换。
> //你需要安装 otf2bdf 工具，它可以将 OTF 格式转换为 BDF 格式。你可以通过在 CentOS 上编译安装 otf2bdf 或者寻找相应的软件包。
> //假设你已经有了 OTF 格式的字体文件 myfont.otf，首先将其转换为 BDF 格式，然后再将其转换为 PSF 格式。假设你已经安装了 otf2bdf 工具并且可以直接运行。
> 
> //先将 OTF 字体转换为 BDF 格式：这个命令将 myfont.otf 转换为 myfont.bdf 文件，字体大小为 16 像素，分辨率为 72dpi。
> otf2bdf -p 16 -r 72 myfont.otf -o myfont.bdf
> 
> // 接下来，将 BDF 格式的字体转换为 PSF 格式：这个命令将 myfont.bdf 转换为 myfont.psf 文件，并将其放置到 /usr/share/kbd/consolefonts/ 目录下。
> bdf2psf --fb myfont.bdf /usr/share/kbd/consolefonts/myfont.psf
> 
> //最后，你可以使用 setfont 命令来应用该 PSF 格式的字体到控制台
> sudo setfont myfont.psf
> //记得在编辑 /etc/vconsole.conf 文件来永久更改控制台字体时，使用新的 PSF 文件名。
> //请注意，转换字体可能会涉及一些复杂的细节，比如字体大小、分辨率等，这些参数需要根据你的需求进行调整。
> ```

然后并没有执行，我发现太麻烦了，也不是不能用。而且很无语，怎么这么麻烦啊！GUI的发明很伟大！一键切换各种字体和字号！

# 总结

基本在parallel中已经搞定了有了一个纯黑界面的终端centos7，后续虽然其实我看课程tittle好多都会，但还是听听看，毕竟一个小小的安装我都搞出来了这么一篇长文。

- chatGPT很好用，但也会走弯路，要注意不要过分发问。
- Linux的纯终端，真的是用个比方就是车中皮卡，皮糙肉厚的基于直觉打补丁就能用上几十年；放在修真四万年的网文里，就是玄骨战甲-乞丐版.



